{"ast":null,"code":"var IndexFile,\n  WordNetFile,\n  fs,\n  util,\n  extend = function (child, parent) {\n    for (var key in parent) {\n      if (hasProp.call(parent, key)) child[key] = parent[key];\n    }\n    function ctor() {\n      this.constructor = child;\n    }\n    ctor.prototype = parent.prototype;\n    child.prototype = new ctor();\n    child.__super__ = parent.prototype;\n    return child;\n  },\n  hasProp = {}.hasOwnProperty;\nWordNetFile = require('./wordnet_file');\nfs = require('fs');\nutil = require('util');\nmodule.exports = IndexFile = function (superClass) {\n  var _findAt, _findPrevEOL, _getFileSize, _readLine;\n  extend(IndexFile, superClass);\n  function IndexFile(dataDir, name) {\n    IndexFile.__super__.constructor.call(this, dataDir, 'index.' + name);\n  }\n  _findPrevEOL = function (self, fd, pos, callback) {\n    var buff;\n    buff = new Buffer(1024);\n    if (pos === 0) {\n      return callback(null, 0);\n    } else {\n      return fs.read(fd, buff, 0, 1, pos, function (err, count) {\n        if (err != null) {\n          return callback(err, count);\n        }\n        if (buff[0] === 10) {\n          return callback(null, pos + 1);\n        } else {\n          return _findPrevEOL(self, fd, pos - 1, callback);\n        }\n      });\n    }\n  };\n  _readLine = function (self, fd, pos, callback) {\n    var buff;\n    buff = new Buffer(1024);\n    return _findPrevEOL(self, fd, pos, function (err, pos) {\n      if (err != null) {\n        return callback(err, pos);\n      }\n      return self.appendLineChar(fd, pos, 0, buff, callback);\n    });\n  };\n  _findAt = function (self, fd, size, pos, lastPos, adjustment, searchKey, callback, lastKey) {\n    if (lastPos === pos || pos >= size) {\n      return callback(null, {\n        status: 'miss'\n      });\n    } else {\n      return _readLine(self, fd, pos, function (err, line) {\n        var key, tokens;\n        if (err != null) {\n          return callback(err);\n        }\n        tokens = line.split(/\\s+/);\n        key = tokens[0];\n        if (key === searchKey) {\n          return callback(null, {\n            status: 'hit',\n            key: key,\n            'line': line,\n            tokens: tokens\n          });\n        } else if (adjustment === 1 || key === lastKey) {\n          return callback(null, {\n            status: 'miss'\n          });\n        } else {\n          adjustment = Math.ceil(adjustment * 0.5);\n          if (key < searchKey) {\n            return _findAt(self, fd, size, pos + adjustment, pos, adjustment, searchKey, callback, key);\n          } else {\n            return _findAt(self, fd, size, pos - adjustment, pos, adjustment, searchKey, callback, key);\n          }\n        }\n      });\n    }\n  };\n  _getFileSize = function (path) {\n    var stat;\n    stat = fs.statSync(path);\n    return stat.size;\n  };\n  IndexFile.prototype.find = function (searchKey, callback) {\n    var self;\n    self = this;\n    return this.open(function (err, fd) {\n      var pos, size;\n      if (err != null) {\n        return callback(err, null);\n      }\n      size = _getFileSize(this.filePath) - 1;\n      pos = Math.ceil(size / 2);\n      return _findAt(self, fd, size, pos, null, pos, searchKey, function (err, result) {\n        return callback.call(self, err, result);\n      });\n    });\n  };\n  IndexFile.prototype.lookupFromFile = function (word, callback) {\n    return this.find(word, function (err, record) {\n      var i, indexRecord, j, k, offsets, ptrs, ref, ref1;\n      if (err != null) {\n        return callback.call(this, err, null);\n      }\n      indexRecord = null;\n      if (record.status === 'hit') {\n        ptrs = [];\n        offsets = [];\n        for (i = j = 0, ref = parseInt(record.tokens[3]) - 1; j <= ref; i = j += 1) {\n          ptrs.push(record.tokens[i]);\n        }\n        for (i = k = 0, ref1 = parseInt(record.tokens[2]) - 1; k <= ref1; i = k += 1) {\n          offsets.push(parseInt(record.tokens[ptrs.length + 6 + i], 10));\n        }\n        indexRecord = {\n          lemma: record.tokens[0],\n          pos: record.tokens[1],\n          ptrSymbol: ptrs,\n          senseCnt: parseInt(record.tokens[ptrs.length + 4], 10),\n          tagsenseCnt: parseInt(record.tokens[ptrs.length + 5], 10),\n          synsetOffset: offsets\n        };\n      }\n      return callback.call(this, null, indexRecord);\n    });\n  };\n  IndexFile.prototype.lookup = function (word, callback) {\n    return this.lookupFromFile(word, callback);\n  };\n  return IndexFile;\n}(WordNetFile);","map":{"version":3,"names":["IndexFile","WordNetFile","fs","util","extend","child","parent","key","hasProp","call","ctor","constructor","prototype","__super__","hasOwnProperty","require","module","exports","superClass","_findAt","_findPrevEOL","_getFileSize","_readLine","dataDir","name","self","fd","pos","callback","buff","Buffer","read","err","count","appendLineChar","size","lastPos","adjustment","searchKey","lastKey","status","line","tokens","split","Math","ceil","path","stat","statSync","find","open","filePath","result","lookupFromFile","word","record","i","indexRecord","j","k","offsets","ptrs","ref","ref1","parseInt","push","length","lemma","ptrSymbol","senseCnt","tagsenseCnt","synsetOffset","lookup"],"sources":["/var/home/dadmin/hackapp/node_modules/node-wordnet/lib/index_file.js"],"sourcesContent":["var IndexFile, WordNetFile, fs, util,\n  extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n  hasProp = {}.hasOwnProperty;\n\nWordNetFile = require('./wordnet_file');\n\nfs = require('fs');\n\nutil = require('util');\n\nmodule.exports = IndexFile = (function(superClass) {\n  var _findAt, _findPrevEOL, _getFileSize, _readLine;\n\n  extend(IndexFile, superClass);\n\n  function IndexFile(dataDir, name) {\n    IndexFile.__super__.constructor.call(this, dataDir, 'index.' + name);\n  }\n\n  _findPrevEOL = function(self, fd, pos, callback) {\n    var buff;\n    buff = new Buffer(1024);\n    if (pos === 0) {\n      return callback(null, 0);\n    } else {\n      return fs.read(fd, buff, 0, 1, pos, function(err, count) {\n        if (err != null) {\n          return callback(err, count);\n        }\n        if (buff[0] === 10) {\n          return callback(null, pos + 1);\n        } else {\n          return _findPrevEOL(self, fd, pos - 1, callback);\n        }\n      });\n    }\n  };\n\n  _readLine = function(self, fd, pos, callback) {\n    var buff;\n    buff = new Buffer(1024);\n    return _findPrevEOL(self, fd, pos, function(err, pos) {\n      if (err != null) {\n        return callback(err, pos);\n      }\n      return self.appendLineChar(fd, pos, 0, buff, callback);\n    });\n  };\n\n  _findAt = function(self, fd, size, pos, lastPos, adjustment, searchKey, callback, lastKey) {\n    if (lastPos === pos || pos >= size) {\n      return callback(null, {\n        status: 'miss'\n      });\n    } else {\n      return _readLine(self, fd, pos, function(err, line) {\n        var key, tokens;\n        if (err != null) {\n          return callback(err);\n        }\n        tokens = line.split(/\\s+/);\n        key = tokens[0];\n        if (key === searchKey) {\n          return callback(null, {\n            status: 'hit',\n            key: key,\n            'line': line,\n            tokens: tokens\n          });\n        } else if (adjustment === 1 || key === lastKey) {\n          return callback(null, {\n            status: 'miss'\n          });\n        } else {\n          adjustment = Math.ceil(adjustment * 0.5);\n          if (key < searchKey) {\n            return _findAt(self, fd, size, pos + adjustment, pos, adjustment, searchKey, callback, key);\n          } else {\n            return _findAt(self, fd, size, pos - adjustment, pos, adjustment, searchKey, callback, key);\n          }\n        }\n      });\n    }\n  };\n\n  _getFileSize = function(path) {\n    var stat;\n    stat = fs.statSync(path);\n    return stat.size;\n  };\n\n  IndexFile.prototype.find = function(searchKey, callback) {\n    var self;\n    self = this;\n    return this.open(function(err, fd) {\n      var pos, size;\n      if (err != null) {\n        return callback(err, null);\n      }\n      size = _getFileSize(this.filePath) - 1;\n      pos = Math.ceil(size / 2);\n      return _findAt(self, fd, size, pos, null, pos, searchKey, function(err, result) {\n        return callback.call(self, err, result);\n      });\n    });\n  };\n\n  IndexFile.prototype.lookupFromFile = function(word, callback) {\n    return this.find(word, function(err, record) {\n      var i, indexRecord, j, k, offsets, ptrs, ref, ref1;\n      if (err != null) {\n        return callback.call(this, err, null);\n      }\n      indexRecord = null;\n      if (record.status === 'hit') {\n        ptrs = [];\n        offsets = [];\n        for (i = j = 0, ref = parseInt(record.tokens[3]) - 1; j <= ref; i = j += 1) {\n          ptrs.push(record.tokens[i]);\n        }\n        for (i = k = 0, ref1 = parseInt(record.tokens[2]) - 1; k <= ref1; i = k += 1) {\n          offsets.push(parseInt(record.tokens[ptrs.length + 6 + i], 10));\n        }\n        indexRecord = {\n          lemma: record.tokens[0],\n          pos: record.tokens[1],\n          ptrSymbol: ptrs,\n          senseCnt: parseInt(record.tokens[ptrs.length + 4], 10),\n          tagsenseCnt: parseInt(record.tokens[ptrs.length + 5], 10),\n          synsetOffset: offsets\n        };\n      }\n      return callback.call(this, null, indexRecord);\n    });\n  };\n\n  IndexFile.prototype.lookup = function(word, callback) {\n    return this.lookupFromFile(word, callback);\n  };\n\n  return IndexFile;\n\n})(WordNetFile);\n"],"mappings":"AAAA,IAAIA,SAAS;EAAEC,WAAW;EAAEC,EAAE;EAAEC,IAAI;EAClCC,MAAM,GAAG,SAAAA,CAASC,KAAK,EAAEC,MAAM,EAAE;IAAE,KAAK,IAAIC,GAAG,IAAID,MAAM,EAAE;MAAE,IAAIE,OAAO,CAACC,IAAI,CAACH,MAAM,EAAEC,GAAG,CAAC,EAAEF,KAAK,CAACE,GAAG,CAAC,GAAGD,MAAM,CAACC,GAAG,CAAC;IAAE;IAAE,SAASG,IAAIA,CAAA,EAAG;MAAE,IAAI,CAACC,WAAW,GAAGN,KAAK;IAAE;IAAEK,IAAI,CAACE,SAAS,GAAGN,MAAM,CAACM,SAAS;IAAEP,KAAK,CAACO,SAAS,GAAG,IAAIF,IAAI,CAAC,CAAC;IAAEL,KAAK,CAACQ,SAAS,GAAGP,MAAM,CAACM,SAAS;IAAE,OAAOP,KAAK;EAAE,CAAC;EAC1RG,OAAO,GAAG,CAAC,CAAC,CAACM,cAAc;AAE7Bb,WAAW,GAAGc,OAAO,CAAC,gBAAgB,CAAC;AAEvCb,EAAE,GAAGa,OAAO,CAAC,IAAI,CAAC;AAElBZ,IAAI,GAAGY,OAAO,CAAC,MAAM,CAAC;AAEtBC,MAAM,CAACC,OAAO,GAAGjB,SAAS,GAAI,UAASkB,UAAU,EAAE;EACjD,IAAIC,OAAO,EAAEC,YAAY,EAAEC,YAAY,EAAEC,SAAS;EAElDlB,MAAM,CAACJ,SAAS,EAAEkB,UAAU,CAAC;EAE7B,SAASlB,SAASA,CAACuB,OAAO,EAAEC,IAAI,EAAE;IAChCxB,SAAS,CAACa,SAAS,CAACF,WAAW,CAACF,IAAI,CAAC,IAAI,EAAEc,OAAO,EAAE,QAAQ,GAAGC,IAAI,CAAC;EACtE;EAEAJ,YAAY,GAAG,SAAAA,CAASK,IAAI,EAAEC,EAAE,EAAEC,GAAG,EAAEC,QAAQ,EAAE;IAC/C,IAAIC,IAAI;IACRA,IAAI,GAAG,IAAIC,MAAM,CAAC,IAAI,CAAC;IACvB,IAAIH,GAAG,KAAK,CAAC,EAAE;MACb,OAAOC,QAAQ,CAAC,IAAI,EAAE,CAAC,CAAC;IAC1B,CAAC,MAAM;MACL,OAAO1B,EAAE,CAAC6B,IAAI,CAACL,EAAE,EAAEG,IAAI,EAAE,CAAC,EAAE,CAAC,EAAEF,GAAG,EAAE,UAASK,GAAG,EAAEC,KAAK,EAAE;QACvD,IAAID,GAAG,IAAI,IAAI,EAAE;UACf,OAAOJ,QAAQ,CAACI,GAAG,EAAEC,KAAK,CAAC;QAC7B;QACA,IAAIJ,IAAI,CAAC,CAAC,CAAC,KAAK,EAAE,EAAE;UAClB,OAAOD,QAAQ,CAAC,IAAI,EAAED,GAAG,GAAG,CAAC,CAAC;QAChC,CAAC,MAAM;UACL,OAAOP,YAAY,CAACK,IAAI,EAAEC,EAAE,EAAEC,GAAG,GAAG,CAAC,EAAEC,QAAQ,CAAC;QAClD;MACF,CAAC,CAAC;IACJ;EACF,CAAC;EAEDN,SAAS,GAAG,SAAAA,CAASG,IAAI,EAAEC,EAAE,EAAEC,GAAG,EAAEC,QAAQ,EAAE;IAC5C,IAAIC,IAAI;IACRA,IAAI,GAAG,IAAIC,MAAM,CAAC,IAAI,CAAC;IACvB,OAAOV,YAAY,CAACK,IAAI,EAAEC,EAAE,EAAEC,GAAG,EAAE,UAASK,GAAG,EAAEL,GAAG,EAAE;MACpD,IAAIK,GAAG,IAAI,IAAI,EAAE;QACf,OAAOJ,QAAQ,CAACI,GAAG,EAAEL,GAAG,CAAC;MAC3B;MACA,OAAOF,IAAI,CAACS,cAAc,CAACR,EAAE,EAAEC,GAAG,EAAE,CAAC,EAAEE,IAAI,EAAED,QAAQ,CAAC;IACxD,CAAC,CAAC;EACJ,CAAC;EAEDT,OAAO,GAAG,SAAAA,CAASM,IAAI,EAAEC,EAAE,EAAES,IAAI,EAAER,GAAG,EAAES,OAAO,EAAEC,UAAU,EAAEC,SAAS,EAAEV,QAAQ,EAAEW,OAAO,EAAE;IACzF,IAAIH,OAAO,KAAKT,GAAG,IAAIA,GAAG,IAAIQ,IAAI,EAAE;MAClC,OAAOP,QAAQ,CAAC,IAAI,EAAE;QACpBY,MAAM,EAAE;MACV,CAAC,CAAC;IACJ,CAAC,MAAM;MACL,OAAOlB,SAAS,CAACG,IAAI,EAAEC,EAAE,EAAEC,GAAG,EAAE,UAASK,GAAG,EAAES,IAAI,EAAE;QAClD,IAAIlC,GAAG,EAAEmC,MAAM;QACf,IAAIV,GAAG,IAAI,IAAI,EAAE;UACf,OAAOJ,QAAQ,CAACI,GAAG,CAAC;QACtB;QACAU,MAAM,GAAGD,IAAI,CAACE,KAAK,CAAC,KAAK,CAAC;QAC1BpC,GAAG,GAAGmC,MAAM,CAAC,CAAC,CAAC;QACf,IAAInC,GAAG,KAAK+B,SAAS,EAAE;UACrB,OAAOV,QAAQ,CAAC,IAAI,EAAE;YACpBY,MAAM,EAAE,KAAK;YACbjC,GAAG,EAAEA,GAAG;YACR,MAAM,EAAEkC,IAAI;YACZC,MAAM,EAAEA;UACV,CAAC,CAAC;QACJ,CAAC,MAAM,IAAIL,UAAU,KAAK,CAAC,IAAI9B,GAAG,KAAKgC,OAAO,EAAE;UAC9C,OAAOX,QAAQ,CAAC,IAAI,EAAE;YACpBY,MAAM,EAAE;UACV,CAAC,CAAC;QACJ,CAAC,MAAM;UACLH,UAAU,GAAGO,IAAI,CAACC,IAAI,CAACR,UAAU,GAAG,GAAG,CAAC;UACxC,IAAI9B,GAAG,GAAG+B,SAAS,EAAE;YACnB,OAAOnB,OAAO,CAACM,IAAI,EAAEC,EAAE,EAAES,IAAI,EAAER,GAAG,GAAGU,UAAU,EAAEV,GAAG,EAAEU,UAAU,EAAEC,SAAS,EAAEV,QAAQ,EAAErB,GAAG,CAAC;UAC7F,CAAC,MAAM;YACL,OAAOY,OAAO,CAACM,IAAI,EAAEC,EAAE,EAAES,IAAI,EAAER,GAAG,GAAGU,UAAU,EAAEV,GAAG,EAAEU,UAAU,EAAEC,SAAS,EAAEV,QAAQ,EAAErB,GAAG,CAAC;UAC7F;QACF;MACF,CAAC,CAAC;IACJ;EACF,CAAC;EAEDc,YAAY,GAAG,SAAAA,CAASyB,IAAI,EAAE;IAC5B,IAAIC,IAAI;IACRA,IAAI,GAAG7C,EAAE,CAAC8C,QAAQ,CAACF,IAAI,CAAC;IACxB,OAAOC,IAAI,CAACZ,IAAI;EAClB,CAAC;EAEDnC,SAAS,CAACY,SAAS,CAACqC,IAAI,GAAG,UAASX,SAAS,EAAEV,QAAQ,EAAE;IACvD,IAAIH,IAAI;IACRA,IAAI,GAAG,IAAI;IACX,OAAO,IAAI,CAACyB,IAAI,CAAC,UAASlB,GAAG,EAAEN,EAAE,EAAE;MACjC,IAAIC,GAAG,EAAEQ,IAAI;MACb,IAAIH,GAAG,IAAI,IAAI,EAAE;QACf,OAAOJ,QAAQ,CAACI,GAAG,EAAE,IAAI,CAAC;MAC5B;MACAG,IAAI,GAAGd,YAAY,CAAC,IAAI,CAAC8B,QAAQ,CAAC,GAAG,CAAC;MACtCxB,GAAG,GAAGiB,IAAI,CAACC,IAAI,CAACV,IAAI,GAAG,CAAC,CAAC;MACzB,OAAOhB,OAAO,CAACM,IAAI,EAAEC,EAAE,EAAES,IAAI,EAAER,GAAG,EAAE,IAAI,EAAEA,GAAG,EAAEW,SAAS,EAAE,UAASN,GAAG,EAAEoB,MAAM,EAAE;QAC9E,OAAOxB,QAAQ,CAACnB,IAAI,CAACgB,IAAI,EAAEO,GAAG,EAAEoB,MAAM,CAAC;MACzC,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ,CAAC;EAEDpD,SAAS,CAACY,SAAS,CAACyC,cAAc,GAAG,UAASC,IAAI,EAAE1B,QAAQ,EAAE;IAC5D,OAAO,IAAI,CAACqB,IAAI,CAACK,IAAI,EAAE,UAAStB,GAAG,EAAEuB,MAAM,EAAE;MAC3C,IAAIC,CAAC,EAAEC,WAAW,EAAEC,CAAC,EAAEC,CAAC,EAAEC,OAAO,EAAEC,IAAI,EAAEC,GAAG,EAAEC,IAAI;MAClD,IAAI/B,GAAG,IAAI,IAAI,EAAE;QACf,OAAOJ,QAAQ,CAACnB,IAAI,CAAC,IAAI,EAAEuB,GAAG,EAAE,IAAI,CAAC;MACvC;MACAyB,WAAW,GAAG,IAAI;MAClB,IAAIF,MAAM,CAACf,MAAM,KAAK,KAAK,EAAE;QAC3BqB,IAAI,GAAG,EAAE;QACTD,OAAO,GAAG,EAAE;QACZ,KAAKJ,CAAC,GAAGE,CAAC,GAAG,CAAC,EAAEI,GAAG,GAAGE,QAAQ,CAACT,MAAM,CAACb,MAAM,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEgB,CAAC,IAAII,GAAG,EAAEN,CAAC,GAAGE,CAAC,IAAI,CAAC,EAAE;UAC1EG,IAAI,CAACI,IAAI,CAACV,MAAM,CAACb,MAAM,CAACc,CAAC,CAAC,CAAC;QAC7B;QACA,KAAKA,CAAC,GAAGG,CAAC,GAAG,CAAC,EAAEI,IAAI,GAAGC,QAAQ,CAACT,MAAM,CAACb,MAAM,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEiB,CAAC,IAAII,IAAI,EAAEP,CAAC,GAAGG,CAAC,IAAI,CAAC,EAAE;UAC5EC,OAAO,CAACK,IAAI,CAACD,QAAQ,CAACT,MAAM,CAACb,MAAM,CAACmB,IAAI,CAACK,MAAM,GAAG,CAAC,GAAGV,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;QAChE;QACAC,WAAW,GAAG;UACZU,KAAK,EAAEZ,MAAM,CAACb,MAAM,CAAC,CAAC,CAAC;UACvBf,GAAG,EAAE4B,MAAM,CAACb,MAAM,CAAC,CAAC,CAAC;UACrB0B,SAAS,EAAEP,IAAI;UACfQ,QAAQ,EAAEL,QAAQ,CAACT,MAAM,CAACb,MAAM,CAACmB,IAAI,CAACK,MAAM,GAAG,CAAC,CAAC,EAAE,EAAE,CAAC;UACtDI,WAAW,EAAEN,QAAQ,CAACT,MAAM,CAACb,MAAM,CAACmB,IAAI,CAACK,MAAM,GAAG,CAAC,CAAC,EAAE,EAAE,CAAC;UACzDK,YAAY,EAAEX;QAChB,CAAC;MACH;MACA,OAAOhC,QAAQ,CAACnB,IAAI,CAAC,IAAI,EAAE,IAAI,EAAEgD,WAAW,CAAC;IAC/C,CAAC,CAAC;EACJ,CAAC;EAEDzD,SAAS,CAACY,SAAS,CAAC4D,MAAM,GAAG,UAASlB,IAAI,EAAE1B,QAAQ,EAAE;IACpD,OAAO,IAAI,CAACyB,cAAc,CAACC,IAAI,EAAE1B,QAAQ,CAAC;EAC5C,CAAC;EAED,OAAO5B,SAAS;AAElB,CAAC,CAAEC,WAAW,CAAC","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}